1Ô∏è‚É£ Nombre y apellido de los cinco malague√±os de m√°s edad

SELECT nombre, apellido
FROM personas
WHERE provincia = 'Malaga'
ORDER BY edad DESC
LIMIT 5;

2Ô∏è‚É£ M√°ximo de ingresos anuales de una persona con estudios primarios

SELECT MAX(ingresos_anuales)
FROM personas
WHERE estudios = 'Primarios';

3Ô∏è‚É£ Edad media de las personas cuya ocupaci√≥n empieza por A
SELECT AVG(edad)
FROM personas
WHERE ocupacion LIKE 'A%';

4Ô∏è‚É£ Las 3 primeras letras del estado civil de las personas de Dos Hermanas
SELECT SUBSTRING(estado_civil, 1, 3)
FROM personas
WHERE municipio = 'Dos Hermanas';

5Ô∏è‚É£ N√∫mero de personas que son padre siendo mujer o madre siendo hombre
SELECT COUNT(*)
FROM personas
WHERE (sexo = 'Mujer' AND rol = 'Padre')
   OR (sexo = 'Hombre' AND rol = 'Madre');

6Ô∏è‚É£ La moda del estado civil
SELECT estado_civil
FROM personas
GROUP BY estado_civil
ORDER BY COUNT(*) DESC
LIMIT 1;

7Ô∏è‚É£ Cu√°ntos municipios distintos de la provincia de C√°diz aparecen
SELECT COUNT(DISTINCT municipio)
FROM personas
WHERE provincia = 'Cadiz';

8Ô∏è‚É£ Media de ingresos anuales agrupada por estado civil
SELECT estado_civil, AVG(ingresos_anuales)
FROM personas
GROUP BY estado_civil;

9Ô∏è‚É£ Los abuelos de la persona con id 1142
SELECT *
FROM personas
WHERE id IN (
    SELECT padre FROM personas WHERE id IN (
        SELECT padre FROM personas WHERE id = 1142
    )
);

üîü Los nietos de la persona con id 1093
SELECT *
FROM personas
WHERE padre IN (
    SELECT id FROM personas WHERE padre = 1093
);

1Ô∏è‚É£1Ô∏è‚É£ Media del n√∫mero de hijos por mujer
SELECT AVG(numero_hijos)
FROM personas
WHERE sexo = 'Mujer';

1Ô∏è‚É£2Ô∏è‚É£ Los 5 granadinos que m√°s cobran ordenados por longitud de su ocupaci√≥n
SELECT *
FROM personas
WHERE provincia = 'Granada'
ORDER BY ingresos_anuales DESC, CHAR_LENGTH(ocupacion) DESC
LIMIT 5;

1Ô∏è‚É£3Ô∏è‚É£ Provincia con menos ingresos anuales de media
SELECT provincia
FROM personas
GROUP BY provincia
ORDER BY AVG(ingresos_anuales)
LIMIT 1;

1Ô∏è‚É£4Ô∏è‚É£ Provincia con jubilados con menores ingresos anuales de media
SELECT provincia
FROM personas
WHERE ocupacion = 'Jubilado'
GROUP BY provincia
ORDER BY AVG(ingresos_anuales)
LIMIT 1;

1Ô∏è‚É£5Ô∏è‚É£ Municipio con m√°s ingresos anuales sin contar personas que no cobran nada
SELECT municipio
FROM personas
WHERE ingresos_anuales > 0
GROUP BY municipio
ORDER BY AVG(ingresos_anuales) DESC
LIMIT 1;

1Ô∏è‚É£6Ô∏è‚É£ Media de edad de personas con alg√∫n hijo cuyo nombre empieza por L
SELECT AVG(edad)
FROM personas
WHERE numero_hijos > 0
  AND nombre LIKE 'L%';

1Ô∏è‚É£7Ô∏è‚É£ Edad media de las personas que sean hermanas de personas de M√°laga municipio
SELECT AVG(edad)
FROM personas
WHERE padre IN (
    SELECT padre FROM personas WHERE municipio = 'Malaga'
);
